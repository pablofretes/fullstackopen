(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{37:function(e,t,n){},59:function(e,t,n){e.exports=n(88)},88:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),u=n(22),o=n.n(u),l=n(16),i=n(107),s=(n(37),function(e){var t=e.blog;return c.a.createElement(i.a,{style:{verticalAlign:"middle",paddingTop:10,paddingLeft:5,paddingBottom:10,border:"solid",borderWidth:3,marginBottom:5},maxWidth:"sm"},c.a.createElement(l.b,{to:"/blogs/".concat(t.id)},t.title," By ",c.a.createElement("strong",null,t.author)))}),p=n(13),m=n(3),f=n.n(m),d=n(7),b=n(20),E=n.n(b),v={login:function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},g=null,h={getAll:function(){return E.a.get("/api/blogs").then((function(e){return e.data}))},create:function(){var e=Object(d.a)(f.a.mark((function e(t){var n,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,E.a.post("/api/blogs",t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){g="bearer ".concat(e)},update:function(){var e=Object(d.a)(f.a.mark((function e(t,n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.put("".concat("/api/blogs","/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:g}},e.next=3,E.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),postComment:function(){var e=Object(d.a)(f.a.mark((function e(t,n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("".concat("/api/blogs","/").concat(t,"/comments"),{comment:n});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},y=function(e,t){return function(){var n=Object(d.a)(f.a.mark((function n(r){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:clearInterval(a),a=setTimeout((function(){r({type:"NOTIFICATION_DELETE"})}),1e3*t),r({type:"NOTIFICATION_GREEN",data:{message:e,type:"success"}});case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},O=function(e,t){return function(){var n=Object(d.a)(f.a.mark((function n(r){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:clearInterval(a),a=setTimeout((function(){r({type:"NOTIFICATION_DELETE"})}),1e3*t),r({type:"NOTIFICATION_RED",data:{message:e,type:"error"}});case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFICATION_GREEN":case"NOTIFICATION_RED":return t.data;case"NOTIFICATION_DELETE":return null;default:return e}},k=function(){var e=window.localStorage.getItem("loggedBlogAppUser");if(e){var t=JSON.parse(e);return h.setToken(t.token),{type:"LOGGED_IN",data:t}}return{type:"LOGOUT"}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOG_IN":case"LOGGED_IN":return t.data;case"LOGOUT":return null;default:return e}},I=function(){var e=Object(p.b)();Object(r.useEffect)((function(){e(k())}));return c.a.createElement("form",{onSubmit:function(t){t.preventDefault();var n=t.target.username.value;t.target.username.value="";var a=t.target.password.value;t.target.password.value="",e(function(e,t){return function(){var n=Object(d.a)(f.a.mark((function n(a){var r;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,v.login({username:e,password:t});case 3:r=n.sent,window.localStorage.setItem("loggedBlogAppUser",JSON.stringify(r)),h.setToken(r.token),a({type:"LOG_IN",data:r}),a(y("Welcome ".concat(r.username),5)),n.next=15;break;case 10:n.prev=10,n.t0=n.catch(0),a(O(n.t0)),a(O("Incorrect Username or Password",5)),window.localStorage.clear();case 15:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e){return n.apply(this,arguments)}}()}(n,a)),e(y("Welcome ".concat(n)),5)}},c.a.createElement("div",null,"username",c.a.createElement("input",{id:"username-input","data-cy":"username",type:"text",name:"username"}),"password",c.a.createElement("input",{id:"password-input","data-cy":"password",type:"password",name:"password"})),c.a.createElement("button",{id:"login-button","data-cy":"login-button",type:"submit"},"Log-in"))},x=n(31),T=function(e){var t=Object(r.useState)(!1),n=Object(x.a)(t,2),a=n[0],u=n[1],o={display:a?"none":""},l={display:a?"":"none"},i=function(){u(!a)};return c.a.createElement("div",null,c.a.createElement("div",{style:o},c.a.createElement("button",{onClick:i},e.buttonLabel)),c.a.createElement("div",{style:l},e.children,c.a.createElement("button",{id:"cancel-button","data-cy":"cancel-button",onClick:i},"Cancel")))},N=n(34),L=n(23),C=function(e){return function(){var t=Object(d.a)(f.a.mark((function t(n){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.create(e);case 2:a=t.sent,n({type:"NEW_BLOG",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},A=function(){return function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S=function(e){return function(){var t=Object(d.a)(f.a.mark((function t(n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.deleteBlog(e.id);case 2:n({type:"DELETE_BLOG",data:e.id});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(console.log("state is",e),console.log("action is",t),t.type){case"NEW_BLOG":return[].concat(Object(L.a)(e),[t.data]);case"INIT_BLOGS":return t.data;case"LIKE":var n=t.data.id,a=e.find((function(e){return e.id===n})),r=Object(N.a)({},a,{likes:a.likes+1});return e.map((function(e){return e.id===n?r:e}));case"DELETE":var c=t.data;return e.blogs.filter((function(e){return e.id!==c}));case"COMMENT":return e.map((function(e){return e.id!==t.data.id?e:t.data}));default:return e}},B=function(){var e=Object(p.b)(),t=function(){var t=Object(d.a)(f.a.mark((function t(n){var a,r,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),a=n.target.title.value,n.target.title.value="",r=n.target.author.value,n.target.author.value="",c=n.target.url.value,n.target.url.value="",e(C({title:a,author:r,url:c}));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return c.a.createElement("div",null,c.a.createElement("form",{onSubmit:t},"Title",c.a.createElement("input",{id:"title","data-cy":"title",type:"text",name:"title"}),c.a.createElement("br",null),"Author",c.a.createElement("input",{id:"author","data-cy":"author",type:"text",name:"author"}),c.a.createElement("br",null),"Url",c.a.createElement("input",{id:"url","data-cy":"url",type:"text",name:"url"}),c.a.createElement("br",null),c.a.createElement("button",{type:"submit","data-cy":"create-button"},"Create")))},G=n(9),U=n(108),D=n(89),F=n(109),R=n(110),W=n(111),M=n(112),J=function(e){var t=e.users;return c.a.createElement("div",null,c.a.createElement("h2",null,"Users"),c.a.createElement(U.a,{component:D.a},c.a.createElement(F.a,null,c.a.createElement(R.a,null,c.a.createElement(W.a,null,c.a.createElement(M.a,null,"Users"),c.a.createElement(M.a,null,"Blogs Created")),t.map((function(e){return c.a.createElement(W.a,{key:e.id},c.a.createElement(M.a,null,c.a.createElement(l.b,{to:"/users/".concat(e.id)},e.name)),c.a.createElement(M.a,null,e.blogs.length))}))))))},z=function(e){var t=e.user;return t?(console.log(t),console.log(t.blogs),c.a.createElement("div",null,t.name,t.blogs.map((function(e){return c.a.createElement("li",{key:e.id},c.a.createElement(l.b,{to:"/blogs/".concat(e.id)},e.title))})))):null},K={getUsers:function(){var e=Object(d.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},H=n(116),P=function(e){var t=e.notification;return t?c.a.createElement("div",null,"success"===t.type?c.a.createElement(H.a,{severity:"success"},t.message):c.a.createElement(H.a,{severity:"error"},t.message)):null},q=function(e){var t=e.blog,n=Object(p.b)(),a=Object(G.f)();Object(r.useEffect)((function(){n(A())}),[n]);var u=function(e){n(function(e){return function(){var t=Object(d.a)(f.a.mark((function t(n){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.update(e.id,Object(N.a)({},e,{likes:e.likes+1}));case 2:a=t.sent,n({type:"LIKE",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(e)),n(y("You have liked ".concat(e.title),5))},o=function(){var e=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.confirm("Are you sure you want to delete the blog ".concat(t.title," by ").concat(t.author," ?"))){e.next=14;break}return e.prev=2,e.next=5,n(S(t));case 5:n(y("Successfully deleted blog ".concat(t.title),5)),a.push("/"),e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(2),n(O("You cant delete this blog",5)),n(O(e.t0,5)),e.abrupt("return",void 0);case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();return c.a.createElement("div",null,c.a.createElement("p",null,t.title," by ",c.a.createElement("strong",null,t.author)),c.a.createElement("p",null,t.url),c.a.createElement("div",{className:"likes-container","data-cy":"like-container"},t.likes," ",c.a.createElement("button",{className:"like-button","data-cy":"like-button",onClick:function(){return u(t)}},"Like")),c.a.createElement("p",null,t.user.username),c.a.createElement("button",{className:"delete-button","data-cy":"delete-button",onClick:function(){return o(t)}},"Delete"),c.a.createElement("br",null),c.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=e.target.comment.value;e.target.comment.value="",n(function(e,t){return function(){var n=Object(d.a)(f.a.mark((function n(a){var r;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h.postComment(t.id,e);case 2:r=n.sent,a({type:"COMMENT",data:r});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(a,t))}},c.a.createElement("input",{id:"comment",name:"comment",placeholder:"Add a comment"}),c.a.createElement("button",{type:"submit"},"Comment")),c.a.createElement("h2",null,"Comments"),c.a.createElement("ul",null,console.log(t.comments),t.comments.map((function(e){return c.a.createElement("li",{key:e.id},e.comment)}))))},Q=n(113),V=n(115),X=n(114),Z=function(){var e=Object(p.b)(),t=Object(G.f)();Object(r.useEffect)((function(){e(k())}),[e]),Object(r.useEffect)((function(){e(function(){var e=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.getUsers();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]),Object(r.useEffect)((function(){e(A())}),[e]);var n=Object(p.c)((function(e){return e.blogs})),a=Object(p.c)((function(e){return e.login})),u=Object(p.c)((function(e){return e.users})),o=Object(p.c)((function(e){return e.notification})),m=Object(G.g)("/users/:id"),b=m?u.find((function(e){return e.id===m.params.id})):null,E=Object(G.g)("/blogs/:id"),v=E?n.find((function(e){return e.id===E.params.id})):null;return c.a.createElement(i.a,null,c.a.createElement("div",null,c.a.createElement(P,{notification:o})),c.a.createElement(Q.a,{position:"static"},c.a.createElement(X.a,null,c.a.createElement(V.a,{color:"inherit",component:l.b,to:"/"},"Home"),c.a.createElement(V.a,{color:"inherit",component:l.b,to:"/users"},"Users"),null===a?c.a.createElement(V.a,{color:"inherit",component:l.b,to:"/login"},"Login"):c.a.createElement("div",null,c.a.createElement("em",null,a.username," logged in"),c.a.createElement(V.a,{color:"inherit",onClick:function(){e((window.localStorage.removeItem("loggedBlogAppUser"),{type:"LOGOUT"})),t.push("/")}},"Logout")))),c.a.createElement(G.c,null,c.a.createElement(G.a,{path:"/users/:id"},c.a.createElement(z,{user:b})),c.a.createElement(G.a,{path:"/blogs/:id"},c.a.createElement(q,{blog:v})),c.a.createElement(G.a,{path:"/users"},c.a.createElement(J,{users:u})),c.a.createElement(G.a,{path:"/"},null===a?c.a.createElement(I,null):c.a.createElement("div",null,c.a.createElement(T,{buttonLabel:"Create new Blog"},c.a.createElement(B,null)),c.a.createElement("div",null,c.a.createElement("h2",null,"blogs"),n.sort((function(e,t){return t.likes-e.likes}))&&n.map((function(e){return c.a.createElement(s,{key:e.id,blog:e})})))))))},$=n(29),ee=n(51),te=n(52),ne=Object($.combineReducers)({login:j,blogs:_,notification:w,users:Y}),ae=Object($.createStore)(ne,Object(te.composeWithDevTools)(Object($.applyMiddleware)(ee.a)));o.a.render(c.a.createElement(p.a,{store:ae},c.a.createElement(l.a,null,c.a.createElement(Z,null))),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.a8b69879.chunk.js.map